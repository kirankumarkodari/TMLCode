<%@ Page Language="C#" AutoEventWireup="true" CodeBehind="Default.aspx.cs" Inherits="TataMotorsWebAPI.Default" %>

<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <title>TATA Motors::Wind Power Credit Adjustment</title>    
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <link rel="icon" href="images/favicon.ico" type="image/gif" sizes="16x16"/>
    <link rel="stylesheet" href="Content/bootstrap.min.css"/>
    <link rel="stylesheet" href="Content/font-awesome.min.css"/>
    <link rel="stylesheet" href="Content/TATAMotors.css"/>
    <link rel="stylesheet" href="Content/loading.css"/>
    <script src="Scripts/jquery.min.js"></script>
    <script src="Scripts/bootstrap.min.js"></script>
    <!--Reference the SignalR library. -->
    <script src="Scripts/jquery.signalR-2.2.1.min.js"></script>
    <!--Reference the autogenerated SignalR hub script. -->
    <script src="signalr/hubs"></script>
    <script src="Scripts/tmlprocess.js"></script>
    
    <script type="text/javascript">
        $(document).ready(function () {
            $('#billRatesLoading-modal').modal('show');
            $.ajax({
                type: "GET",
                url: "Services/Process/GetAdditionalInfo",
                success: displayInfo,
                failure: reportError
            });
        });
            function displayInfo(result)
            {
                //alert(result);
                document.getElementById("Field1").value = result.MSEDCL.MD_CHARGE;
                document.getElementById("Field2").value = result.MSEDCL.BASIC_CHARGE;
                document.getElementById("Field3").value = result.MSEDCL.AZONEVAL;
                document.getElementById("Field4").value = result.MSEDCL.BZONEVAL;
                document.getElementById("Field5").value = result.MSEDCL.CZONEVAL;
                document.getElementById("Field6").value = result.MSEDCL.DZONEVAL;
                document.getElementById("Field7").value = result.MSEDCL.FAC;
                document.getElementById("Field8").value = result.MSEDCL.ELEC_CHARGES;
                document.getElementById("Field9").value = result.MSEDCL.TAX_CHARGE;
                document.getElementById("Field10").value = result.MSEDCL.PF;
                document.getElementById("Field11").value = result.MSEDCL.EHV;
                document.getElementById("Field12").value = result.MSEDCL.PROMPTPAY;

                document.getElementById("Field13").value = result.Others.MD_CHARGE;
                document.getElementById("Field14").value = result.Others.BASIC_CHARGE;
                document.getElementById("Field15").value = result.Others.AZONEVAL;
                document.getElementById("Field16").value = result.Others.BZONEVAL;
                document.getElementById("Field17").value = result.Others.CZONEVAL;
                document.getElementById("Field18").value = result.Others.DZONEVAL;
                document.getElementById("Field19").value = result.Others.FAC;
                document.getElementById("Field20").value = result.Others.ELEC_CHARGES;
                document.getElementById("Field21").value = result.Others.TAX_CHARGE;
                document.getElementById("Field22").value = result.Others.PF;
                document.getElementById("Field23").value = result.Others.EHV;
                document.getElementById("Field24").value = result.Others.PROMPTPAY;

                document.getElementById("CrossCharges").value = result.CrossCharges;
                document.getElementById("WheelingCharges").value = result.WheelingCharges;
                document.getElementById("TransCharges").value = result.TransCharges;
                document.getElementById("OthPurDiscnt").value = result.OthPurDiscnt;
                $('#billRatesLoading-modal').modal('hide');
            }

            function reportError(result)
            {
                $('#billRatesLoading-modal').modal('hide');
            }

    </script>

</head>
<body>
   <div class="container-fluid">
      <div id="heading" class="row">
          <div  class="col-lg-12">
              <h1>Wind Power Credit Adjustment</h1>
          </div>
      </div>
       
       <div id="logoRow" class="row">
          <div id="TATAMotorsLogo" class="col-lg-6">
            <img id="tata" class="img-responsive" src="images/Tata_Motors_Logo.png" alt="TATAMotorsLogo" width="250px" />  
          </div>
           <div id="effLogo" class="col-lg-2 col-lg-offset-4">
            <p id="poweredTxt">Powered by<a href="http://www.efftronics.com" target="_blank"><img class="img-responsive" src="images/efftronics_logo.png" width="200px" alt="Efftronicslogo"/></a></p>  
          </div>
           
      </div>
       <form id="form1" action="javascript:;" enctype="multipart/form-data" accept-charset="utf-8">
       <div id="formRow" class="row">
           <div id="formCol" class="col-lg-10 col-md-10 col-lg-offset-1 col-md-offset-1">
               
                  <table class="fileUploadtable">
                      <tr>
                          <td><h4>Consumption File: <i class="fa fa-file-pdf-o" aria-hidden="true"></i></h4></td>
                          <td><h4>Generation  File: <i class="fa fa-file-pdf-o" aria-hidden="true"></i></h4></td>
                          <td><h4>Time Slot Consumption File: <i class="fa fa-file-pdf-o" aria-hidden="true"></i></h4></td>                          
                      </tr>
                      <tr>
                          <td class="fileUpload"><input type="file" id="ConsumptionFile" title="CONS_TSR_170149001878" accept="application/pdf"/></td>
                          <td class="fileUpload"><input type="file" id="GenerationFile" title="GEN_TSR_170149001878" accept="application/pdf"/></td>
                          <td class="fileUpload"><input type="file" id="TimeSlotConsumptionFile" title="TSC-170149001878" accept="application/pdf"/></td>
                      </tr>                      
                      <tr>
                          <td><h4>Meter Consumption File: <i class="fa fa-file-pdf-o" aria-hidden="true"></i></h4></td>
                          <td><h4>Open Access Bill File: <i class="fa fa-file-pdf-o" aria-hidden="true"></i></h4></td>                          
                      </tr>
                      <tr>
                          <td class="fileUpload"><input type="file" id="MeterConsumptionFile" title="MTR_CONS_OA-170149001878" accept="application/pdf"/></td>
                          <td class="fileUpload"><input type="file" id="OpenAccessFile" title="OPEN_ACCESS_BILL" accept="application/pdf"/></td>                          
                      </tr>
                      <tr>
                          <td></td><td><input type="checkbox" id="chkOverwrite" name="chkOverwrite"/>&nbsp;&nbsp;Overwrite Data</td>
                      </tr>
                      </table>
                   </div>
                </div>     
            <div class="row ratesRow">
           <div class="col-lg-12 col-md-12">
                   <!-- Monthly Rates Entry Table -->
                   <!--  M-MSEDC, T-3rd party  -->
                   <table class="table ratesTable" >
                    <tbody>
                        <tr>
                            <td></td>
                            <td>MD Charges (₹)</td>
                            <td>Basic Energy Charges+Add. Charges (₹)</td>
                            <td>A-Zone(₹)</td>
                            <td>B-Zone(₹)</td>
                            <td>C-Zone (₹)</td>
                            <td>D-Zone (₹)</td>
                            <td>FAC (₹)</td>
                            <td>Electricity Duty (%)</td>
                            <td>Tax on Sale (₹)</td>
                            <td>PF Incentive (%)</td>
                            <td>EHV Rebate (%)</td>
                            <td>Prompt Payment Discount (%)</td>
                            
                        </tr>
                        <tr class="rates">
                            <td><b>MSEDCL</b></td>
                            <td><input type="text" id="Field1" onkeypress="return IsAlphaNumeric(event);" ondrop="return false;" onpaste="return false;"  required="required"/></td>
                            <td><input type="text" id="Field2" onkeypress="return IsAlphaNumeric(event);" ondrop="return false;" onpaste="return false;"  required="required"/></td>
                            <td><input type="text" id="Field3" onkeypress="return IsAlphaNumeric(event);" ondrop="return false;" onpaste="return false;"  required="required"/></td>
                            <td><input type="text" id="Field4" onkeypress="return IsAlphaNumeric(event);" ondrop="return false;" onpaste="return false;"  required="required"/></td>
                            <td><input type="text" id="Field5" onkeypress="return IsAlphaNumeric(event);" ondrop="return false;" onpaste="return false;"  required="required"/></td>
                            <td><input type="text" id="Field6" onkeypress="return IsAlphaNumeric(event);" ondrop="return false;" onpaste="return false;"  required="required"/></td>
                            <td><input type="text" id="Field7" onkeypress="return IsAlphaNumeric(event);" ondrop="return false;" onpaste="return false;"  required="required"/></td>
                            <td><input type="text" id="Field8" onkeypress="return IsAlphaNumeric(event);" ondrop="return false;" onpaste="return false;"  required="required"/></td>
                            <td><input type="text" id="Field9" onkeypress="return IsAlphaNumeric(event);" ondrop="return false;" onpaste="return false;"  required="required"/></td>
                            <td><input type="text" id="Field10" onkeypress="return IsAlphaNumeric(event);" ondrop="return false;" onpaste="return false;"  required="required"/></td>
                            <td><input type="text" id="Field11" onkeypress="return IsAlphaNumeric(event);" ondrop="return false;" onpaste="return false;"  required="required"/></td>
                            <td><input type="text" id="Field12" onkeypress="return IsAlphaNumeric(event);" ondrop="return false;" onpaste="return false;"  required="required"/></td>
                        </tr>
                        <tr class="rates">
                            <td><b>3<sup>rd</sup>Party</b></td>
                            <td><input type="text" id="Field13" onkeypress="return IsAlphaNumeric(event);" ondrop="return false;" onpaste="return false;"  required="required"/></td>
                            <td><input type="text" id="Field14" onkeypress="return IsAlphaNumeric(event);" ondrop="return false;" onpaste="return false;"  required="required"/></td>
                            <td><input type="text" id="Field15" onkeypress="return IsAlphaNumeric(event);" ondrop="return false;" onpaste="return false;"  required="required"/></td>
                            <td><input type="text" id="Field16" onkeypress="return IsAlphaNumeric(event);" ondrop="return false;" onpaste="return false;"  required="required"/></td>
                            <td><input type="text" id="Field17" onkeypress="return IsAlphaNumeric(event);" ondrop="return false;" onpaste="return false;"  required="required"/></td>
                            <td><input type="text" id="Field18" onkeypress="return IsAlphaNumeric(event);" ondrop="return false;" onpaste="return false;"  required="required"/></td>
                            <td><input type="text" id="Field19" onkeypress="return IsAlphaNumeric(event);" ondrop="return false;" onpaste="return false;"  required="required"/></td>
                            <td><input type="text" id="Field20" onkeypress="return IsAlphaNumeric(event);" ondrop="return false;" onpaste="return false;"  required="required"/></td>
                            <td><input type="text" id="Field21" onkeypress="return IsAlphaNumeric(event);" ondrop="return false;" onpaste="return false;"  required="required"/></td>
                            <td><input type="text" id="Field22" onkeypress="return IsAlphaNumeric(event);" ondrop="return false;" onpaste="return false;"  required="required"/></td>
                            <td><input type="text" id="Field23" onkeypress="return IsAlphaNumeric(event);" ondrop="return false;" onpaste="return false;"  required="required"/></td>
                            <td><input type="text" id="Field24" onkeypress="return IsAlphaNumeric(event);" ondrop="return false;" onpaste="return false;"  required="required"/></td>
                        </tr>
                                  
                        </tbody>
                    </table>
               </div>             
              </div>
           <div class="row chargesRow">
                  <div class="col-lg-12 col-md-12">
                   <!-- Sur Charges Entry Table -->
                    <table class="table table-striped">
                        <thead>
                            <tr>
                                <th>Cross Sur Charges</th>
                                <th>Wheeling Charges</th>
                                <th>Transmission Charges</th>
                                <th>Other Purchase Discount</th>        
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><input type="text" id="CrossCharges" name="CrossCharges" placeholder="Enter Cross Sur Charges" onkeypress="return IsAlphaNumeric(event);" ondrop="return false;" onpaste="return false;" required="required"/></td>
                                <td><input type="text" id="WheelingCharges" name="WheelingCharges" placeholder="Enter Wheeling Charges" onkeypress="return IsAlphaNumeric(event);" ondrop="return false;" onpaste="return false;" required="required"/></td>
                                <td><input type="text" id="TransCharges" name="TransCharges" placeholder="Enter Transmission Charges" onkeypress="return IsAlphaNumeric(event);" ondrop="return false;" onpaste="return false;" required="required"/></td>
                                <td><input type="text" id="OthPurDiscnt" name="OthPurDiscnt" placeholder="Enter Other Purchase Discount Charges" onkeypress="return IsAlphaNumeric(event);" ondrop="return false;" onpaste="return false;" required="required"/></td>
                            </tr>
                            <tr>
                                <td colspan="2"><h3 class="error" style="color: Red; display: none">*Please enter Digits Only</h3></td>
                            </tr>   
                        </tbody>
                </table>
                    </div>
           </div>
           <div class="row">
           <div class="col-lg-3 col-md-3 col-lg-offset-3 col-md-offset-3">
               <input type="button" id="btnUpload" value="Process" onclick="chkFile();"/>
           </div>
           <div class="col-lg-3 col-md-3 col-lg-offset-2 col-md-offset-2">
               <a target="_blank" href="https://app.powerbi.com/view?r=eyJrIjoiZWQ0YTE0YTctZjRhZS00MzYzLTgxN2ItZGFmYTMxZTIzNGY0IiwidCI6IjZhZDY1ZDZkLWZkODctNDQ5OC04ZTkyLTUzNGM3YTA3ZjlmOCIsImMiOjEwfQ%3D%3D" title="Click to View Reports">
                   <img id="reportImg" src="images/Reports.jpg" alt="PowerBIReports" width="250px" /></a>
           </div>
           </div>
       </form>
       <div id="powerBI" class="row">
           <div class="col-lg-12">
               
           </div>
       </div>
  </div>
    <!-- Processing Modal -->
<div class="modal modal-static fade" id="processing-modal" role="dialog" aria-hidden="true" data-backdrop="static" data-keyboard="false">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-body">
                 <div id="ProcessInit" class="row">
                        <div id="Processwait" class="col-lg-12"><i class="fa fa-spinner fa-spin" style="font-size:64px"></i></div>
                </div>
               <!-- Consumption File Progressbar -->
                <div id="ConsProcess" class="row">
                        <div id="ConsProcTitle" class="col-lg-3">Consumption</div>
                        <div class="col-lg-8"> 
                                <div class="progress">
                                     <div id="ConsProgresbar" class="progress-bar progress-bar-success progress-bar-striped" role="progressbar" aria-valuemin="0" aria-valuemax="100" style="width:0%"><p id="ConsProcPerc">0%</p></div>
                                </div>
                        </div>    
                </div>
                <!-- Generation File Progressbar -->
                <div id="GenProcess" class="row">
                        <div id="GenProcTitle" class="col-lg-3">Generation</div>
                        <div class="col-lg-8"> 
                                <div class="progress">
                                     <div id="GenProgresbar" class="progress-bar progress-bar-success progress-bar-striped" role="progressbar" aria-valuemin="0" aria-valuemax="100" style="width:0%"><p id="GenProcPerc">0%</p></div>
                                </div>
                        </div>    
                </div>
                <!-- Time Slot Consum File Progressbar -->
                  <div id="TimeSlotConsProcess" class="row">
                        <div id="TimeSlotConsProcTitle" class="col-lg-3">Time Slot</div>
                        <div class="col-lg-8"> 
                                <div class="progress">
                                     <div id="TimeSlotConsProgresbar" class="progress-bar progress-bar-success progress-bar-striped" role="progressbar" aria-valuemin="0" aria-valuemax="100" style="width:0%"><p id="TimeslotConsProcPerc">0%</p></div>
                                </div>
                        </div>    
                </div>
                <!-- Meter Consumption File Progressbar -->
                  <div id="MeterConsProcess" class="row">
                        <div id="MeterConsProcTitle" class="col-lg-3">Meter Consumption</div>
                        <div class="col-lg-8"> 
                                <div class="progress">
                                     <div id="MeterConsProgresbar" class="progress-bar progress-bar-success progress-bar-striped" role="progressbar" aria-valuemin="0" aria-valuemax="100" style="width:0%"><p id="MeterConsProcPerc">0%</p></div>
                                </div>
                        </div>    
                </div>
                
                <!-- Open Access Bill File Progressbar -->
                  <div id="OpenAccessBillProcess" class="row">
                        <div id="OpenAccessBillProcTitle" class="col-lg-3">Open Access</div>
                        <div class="col-lg-8"> 
                                <div class="progress">
                                     <div id="OpenAccessBillProgresbar" class="progress-bar progress-bar-success progress-bar-striped" role="progressbar" aria-valuemin="0" aria-valuemax="100" style="width:0%"><p id="OpenAccessBillProcPerc">0%</p></div>
                                </div>
                        </div>    
                </div>

                <div id="SucessMsg" class="row">
                        <div class="col-lg-12"><i class="fa fa-check-circle" style="font-size:64px;color:green"></i></div>
                </div>
                <div id="FailureMsg" class="row">
                        <div class="col-lg-12"><i class="fa fa-times-circle-o" style="font-size:64px;color:red"></i></div>
                </div>
                <div id="InfoMsg" class="row">
                        <div class="col-lg-12"><i class="fa fa-exclamation-circle" style="font-size:64px;color:orange"></i></div>
                </div>
                <div id="ProcessMsg" class="row">
                        <div class="col-lg-12"><h4 id="processlbl">Processing...</h4></div>
                </div> 
                <div id="btnOk" class="row">
                        <div class="modal-footer">
                         <button id="ok" type="button" class="btn btn-default" data-dismiss="modal">OK</button>
                       </div>
                </div>               
            </div>
        </div>
    </div>
</div>
    <!-- File Upload Alert Modal -->
    <div class="modal modal-static fade" id="fileUploadAlert-modal" role="dialog" aria-hidden="true" data-backdrop="static" data-keyboard="false">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-body">
               <div id="fileAlertIcon" class="row">
                        <div class="col-lg-12"><i class="fa fa-exclamation-circle" style="font-size:64px;color:orange"></i></div>
                </div>
                <div id="fileAlertMsg" class="row">
                        <div class="col-lg-12"><h4 id="fileAlertlbl">Please Upload Required Files</h4></div>
                </div>
            </div>
            <div class="modal-footer">
          <button id="alertOkBtn" type="button" class="button" data-dismiss="modal">OK</button>          
        </div>
        </div>
    </div>
</div>

    <!-- Start Page Loading Modal -->
    <div class="modal modal-static fade" id="billRatesLoading-modal" role="dialog" aria-hidden="true" data-backdrop="static" data-keyboard="false">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-body">
               <div class="row billRateModalRow">
                       <div class="col-lg-12"><i class="fa fa-spinner fa-spin" style="font-size:64px"></i></div>
                </div>
                <div class="row billRateModalRow">
                        <div class="col-lg-12"><h4>Loading Bill Rate Values....</h4></div>
                </div>
            </div>            
        </div>
    </div>
</div>

</body>
</html>